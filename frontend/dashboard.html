<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



<!-- Add Flatpickr CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

   <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<!-- Optional: Flatpickr dark theme support -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <title>Bookkeeping</title>

 


  
      <link rel="stylesheet" href="style.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

</head>
<body>





  

<div class="navbar">
  
  <div class="dropdown">
    
    <button class="dropbtn">Settings
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
     
      <a href="#" id="full"  onclick="openFullscreen();">Full Screen</a>
     <a href="#" id="close"    onclick="closeFullscreen();">Close Screen</a>
           <a href="#" id="zoomInButton">Zoom In</a>
    <a href="#" id="zoomOutButton">Zoom Out</a>
   <a  href="#" id="resetZoomButton">Reset</a>
    </div>
 
 </div>
<div class="dropdown">
    <button class="dropbtn">Table
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
     
       <a  onclick="logout()">üîê Logout</a>
           <a onclick="showUserManagerModal()">üë• Manage Users</a>
    <a onclick="deleteAllEntries()">üß® Delete All Entries</a>
                <a  onclick="backupData()">üì¶ Backup</a>
 <input type="file" id="restoreFile" style="display:none" onchange="restoreBackup(event)" />
 <a  onclick="document.getElementById('restoreFile').click()">‚ôªÔ∏è Restore</a>
    </div>

 </div>


<div class="dropdown">
    <button class="dropbtn">Export
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
     
  

                <a> <label for="importCSV" class="custom-file-label">üì• Import CSV</label></a>
                <input type="file" id="importCSV" accept=".csv" style="display: none;" />
 <input type="file" id="restoreFile" style="display:none" onchange="restoreBackup(event)" />

  <a onclick="exportVisibleCardEntriesAsCSV()">üì§ Export CSV</a>

<a onclick="window.print()">üñ®Ô∏è Print</a>
<a onclick="window.print()">üßæ Export PDF</a>

     
 </div>
</div>
</div>  

<div class="tabs-wrapper">
 <div class="tabs">
 <button class="tab-button active" onclick="openTab('dashboardTab', this)">üìä  Data</button>
      <button class="tab-button" onclick="openTab('chartsTab', this)">üìà  Chart</button>
    
   

   <button id="themeToggle" onclick="toggleTheme()"> 
    <i id="themeIcon" class="fa-solid fa-moon"></i>
</button>
</div>
</div>


 <!-- Charts Tab -->
  <div id="chartsTab" class="tab-content">
   
    <div class="chart-controls">



 <select id="chartType">
    <option value="bar">Bar</option>
    <option value="line">Line</option>
  </select>

  <select id="filterPerson">
    <option value="All">All</option>
  </select>



<div class="dropdown3">
  <button class="dropdown-toggle3" id="chartDropdownToggle">
    Charts <span style="margin-left: 3px;">‚ñæ</span>
  </button>
  <div class="dropdown-menu" id="chartDropdownMenu">
   <button onclick="downloadChart('monthlyChart')">‚¨áÔ∏è Monthly</button>
      <button onclick="downloadChart('personChart')">‚¨áÔ∏è Person</button>
      <button onclick="downloadChart('comparisonChart')">‚¨áÔ∏è Comparison</button>
      <button onclick="downloadChart('pieChart')">‚¨áÔ∏è Pie</button>
  </div>
</div>
</div>
  

<canvas id="monthlyChart" class="chart-canvas"></canvas>
<canvas id="summaryChart" class="chart-canvas"></canvas>
<canvas id="averageChart" class="chart-canvas"></canvas>
<canvas id="personChart" class="chart-canvas"></canvas>
<canvas id="comparisonChart" class="chart-canvas"></canvas>
<canvas id="pieChart" class="chart-canvas"></canvas>
  </div></div>  

<div class="filter-grid">
 <form id="entryForm" class="entry-form responsive-form">
  <div class="form-grid">
    <input type="text" id="newDate" placeholder="Select Date" class="flatpickr-input">
    <input type="text" id="newDescription" placeholder="Description" required />
    <input type="number" step="0.01" id="newAmount" style="text-align: left;" placeholder="Amount" required />

    <select id="newCurrency" required>
      <option value="CHF">CHF</option>
      <option value="EUR">EUR</option>
      <option value="USD">USD</option>
    </select>

    <select id="newType">
      <option>Income</option>
      <option>Expense</option>
      <option>Transfer</option>
    </select>

    <input list="personList" id="newPerson" placeholder="Person" required />
    <datalist id="personList"></datalist>

    <input list="bankList" id="newBank" placeholder="Bank" required />
    <datalist id="bankList"></datalist>

    <input type="text" id="newCategory" placeholder="Category" list="newCategoryList" required />
    <datalist id="newCategoryList"></datalist>

    <select id="newStatus" required>
      <option value="Open">Open</option>
      <option value="Paid">Paid</option>
    </select>
 
<button id="entrySubmitBtn" class="add-entry-button" type="submit">Add Entry</button>
    <button id="cancelEditBtn" class="cancel-btn hidden" onclick="cancelEdit()">Cancel</button>
  <div class="form-actions">
    
  </div> </div>
</form>
   
       </div>



</form>
</div>


     </div>
  </div>


<h3 style="margin-left: 10px; margin-bottom: -10px; font-size: 0.9rem; color: #727272;">Bank Balances</h3>
<div class="filter-grid2">
  
    <!-- Original table rendering (can stay for fallback/testing) -->
<div id="bankBalanceTableContainer" ></div>
</div>
<!-- New card-based layout -->
<div id="bankBalanceCards" class="balance-card-grid"></div>




<div id="bankBalanceTotals"></div>


<script>
function renderBankBalanceCards() {
  const table = document.querySelector("#bankBalanceTableContainer table");
  if (!table) return;

  const headerCells = table.querySelectorAll("thead th");
  const changeCells = table.querySelectorAll("tbody tr:nth-child(2) td");

  const cardContainer = document.getElementById("bankBalanceCards");
  const totalsContainer = document.getElementById("bankBalanceTotals");
  if (!cardContainer || !totalsContainer) return;

  cardContainer.innerHTML = "";
  totalsContainer.innerHTML = "";

  let totalPlus = 0;
  let totalMinus = 0;

  for (let i = 1; i < headerCells.length; i++) {
    const bank = headerCells[i].textContent.trim();
    const delta = parseFloat(changeCells[i]?.textContent || "0") || 0;

    const card = document.createElement("div");
    card.className = "balance-card";
    card.innerHTML = `
      <small>${bank}</small>
      <div class="change-amount" style="color:${delta < 0 ? '#ff695d' : '#13a07f'}">${delta.toFixed(2)}</div>
    `;
    cardContainer.appendChild(card);

    // Totals
    if (delta > 0) totalPlus += delta;
    else totalMinus += delta;
  }

  // ‚úÖ Append totals inside card
 
if (!totalsContainer) return;

const summaryCard = document.createElement("div");
summaryCard.className = "balance-summary-card";
Differe = `
  <div class="label">Total Plus</div>
  <div class="value" id="v-totalPlus" style="color:#00bfff">+${totalPlus.toFixed(2)}</div>
  <div class="label">Total Minus</div>
  <div class="value" style="color:orangered">${totalMinus.toFixed(2)}</div>
  <div class="label">Difference</div>
  <div class="value" style="color:${(totalPlus + totalMinus) >= 0 ? '#13a07f' : '#ff695d'}">
    ${(totalPlus + totalMinus).toFixed(2)}
  </div>
`;

totalsContainer.appendChild(summaryCard);
}
</script>
<h3 style="margin-left: 10px; margin-top:-2px; margin-bottom: -5px; font-size: 0.9rem; color: #727272;">Kredit Limits</h3>
<div class="filter-grid">
<div class="credit-grid">
  <!-- Input Cards -->
  <div class="card">
    <div>UBS Master</div>
    <input type="number" id="creditLimit-ubs" value="3000" />
  </div>
  <div class="card">
    <div>Corner Master</div>
    <input type="number" id="creditLimit-corner" value="9900" />
  </div>
  <div class="card">
    <div>Post Master</div>
    <input type="number" id="creditLimit-pfm" value="1000" />
  </div>
  <div class="card">
    <div>Cembra</div>
    <input type="number" id="creditLimit-cembra" value="10000" />
  </div>

  <!-- Summary Cards -->
  <div class="card">
    <div>Total Limit</div>
    <strong id="v-totalLimit">0.00</strong>
  </div>
  <div class="card">
    <div>Used</div>
    <strong id="v-totalUsed">0.00</strong>
  </div>
  <div class="card">
    <div>Left</div>
    <strong id="v-diffUsed">0.00</strong>
  </div>
  <div class="card">
    <div>Total Plus</div>
    <strong id="v-limitPlusTotal">0.00</strong>
  </div>

  <!-- Button Card -->
 <!-- Button Card -->
<div class="button-card">
  <button id="unlockBtn">Unlock</button>
  <button id="lockBtn" style="display: none;">Lock & Save</button>
  <button id="saveLimitsBtn" style="display: none;">Save Limits</button>
</div>
</div>
 
  </div>
<div class="filter-grid" >
<div class="summary-totals-card ">
  <div class="summary-card">
    <div class="label">Income</div>
    <a id="totalIncome" class="income-color">0.00</a>
  </div>
  <div class="summary-card">
    <div class="label">Expenses</div>
    <a id="totalExpense" class="expense-color">0.00</a>
  </div>
  <div class="summary-card">
    <div class="label">Balance</div>
    <a id="totalBalance" class="balance-color">0.00</a>
  </div>

 </div>
</div>
<div class="filter-grid" >
<div id="monthlyAverageCard"></div>
  </div>

 </div>

  <div class="tabs-wrapper">
 <div class="tabs">
      <div   id="personMultiSelect" onclick="togglePersonDropdown()">
       <button id="bt1"  id="selectedPersonsLabel">
  üë§&nbsp;&nbsp; person <span style="margin-left: 1px;">‚ñæ</span>
       </button>
        <div class="dropdown-options" id="personOptions" style="display: none;">
          <!-- Checkboxes inserted dynamically here -->
        </div>
 </div> 
       
 <div class="dropdown2">
  <button id="bt1"  class="dropdown-toggle" onclick="toggleDropdown('monthOptions')">üìÖ  &nbsp; month </button>
  <div class="dropdown-content2" id="monthOptions">
    <!-- Checkboxes will be inserted here dynamically -->
  </div>
</div>
     <div class="tooltip-wrapper">
  <button class="reset-btn" onclick="resetFilters()">
    <span class="reset-icon" style="color: black; font-size: 0.8rem;color: rgb(255, 0, 149);">clear all filters</span> 
  </button>
  <span class="tooltip-text">Reset all filters to default</span>
     
     
   
    </div> 
</div>

 </div>
</div>
 </div>

 </div>
</div>





  <div class="filter-grid">

<select id="categoryFilter">
  <option value="All">All</option>
  <option value="Auto">Auto</option>
  <option value="Haus">Haus</option>
  ...
</select>

       
          <select id="typeFilter">
            <option value="">type</option>
            <option>Income</option>
            <option>Expense</option>
            <option>Transfer</option>
          </select>
     
     
          <select id="currencyFilter">
            <option value="">currency</option>
            <option value="CHF">CHF</option>
            <option value="EUR">EUR</option>
            <option value="USD">USD</option>
          </select>
   
       
          <select id="bankFilter">
            <option value="">bank</option>
          </select>
     

     
<select id="statusFilter">
  <option value="All">status</option>
  <option value="Paid">Paid</option>
  <option value="Open">Open</option>
</select>

 <select id="timeSort" onchange="renderEntries()">
    <option value="">dates</option>
    <option value="Today">Today</option>
    <option value="Yesterday">Yesterday</option>
    <option value="This Week">This Week</option>
    <option value="Last Week">Last Week</option>
    <option value="2 Weeks Ago">2 Weeks Ago</option>
    <option value="3 Weeks Ago">3 Weeks Ago</option>
  </select>
     
    
   </div>    
 

   
   
     
  
   </div>


 <div class="filter-grid">
  <div class="filter-field">
    <div class="input-wrapper">
      <input type="text" id="dateSearch" placeholder="date">
      <button class="clear-pill" onclick="clearField('dateSearch')">clear</button>
    </div>
  </div>

  <div class="filter-field">
    <div class="input-wrapper">
      <input type="text" id="amountSearch" placeholder="amount">
      <button class="clear-pill" onclick="clearField('amountSearch')">clear</button>
    </div>
  </div>

  <div class="filter-field">
    <div class="input-wrapper">
      <input type="text" id="categorySearch" placeholder="category">
      <button class="clear-pill" onclick="clearField('categorySearch')">clear</button>
    </div>
  </div>

  <div class="filter-field">
    <div class="input-wrapper">
      <input type="text" id="bankSearch" placeholder="bank">
      <button class="clear-pill" onclick="clearField('bankSearch')">clear</button>
    </div>
  </div>

  <div class="filter-field">
    <div class="input-wrapper">
      <input type="text" id="descSearch" placeholder="description">
      <button class="clear-pill" onclick="clearField('descSearch')">clear</button>
    </div>
  </div>
</div>


  

  <!-- Dashboard Tab -->
  <div id="dashboardTab" class="tab-content active">
   



  <script>




  let chartSizeFactor = 1; // default
let monthlyChartInstance = null;
let personChartInstance = null;
let comparisonChartInstance = null;
let pieChartInstance = null;
let summaryChartInstance = null;
let averageChartInstance = null;

function drawCharts() {
  Chart.register(ChartDataLabels);
const persons = window.persons || [];
  const categoryFilter = document.getElementById('categoryFilter')?.value || 'All';
  const selectedPerson = document.getElementById('filterPerson')?.value || 'All';
  const entries = window.entries || [];

  console.log("üì¶ Entries before filtering:", entries.length, entries);
  console.log("ü™™ Current categoryFilter:", categoryFilter);
  console.log("üë• Selected person:", selectedPerson);

  const monthlyIncome = {}, monthlyExpense = {}, personIncome = {}, personExpense = {}, expenseByCategory = {};

 const excludedPersons = ['Transfer', 'Balance']; // <-- Add any you want to exclude

const filteredEntries = entries.filter(e => {
  const person = (e.person || 'Unknown').trim();
  const category = (e.category || 'Uncategorized').trim();

  const personMatch = (selectedPerson === 'All') || (person === selectedPerson);
  const categoryMatch = (categoryFilter === 'All') || (category === categoryFilter);

  // ‚úÖ Exclude unwanted persons
  const notExcluded = !excludedPersons.includes(person);

  return personMatch && categoryMatch && notExcluded;
});

  console.log("üì¶ Entries after filtering:", filteredEntries.length, filteredEntries);

  filteredEntries.forEach(e => {
    const person = (e.person || 'Unknown').trim();
    const category = e.category || 'Other';
    const month = e.date?.slice(0, 7);
    const value = parseFloat(e.amount) || 0;

    if (e.type === 'Income') {
      monthlyIncome[month] = (monthlyIncome[month] || 0) + value;
      personIncome[person] = (personIncome[person] || 0) + value;
    } else if (e.type === 'Expense') {
      monthlyExpense[month] = (monthlyExpense[month] || 0) + value;
      personExpense[person] = (personExpense[person] || 0) + value;
      expenseByCategory[category] = (expenseByCategory[category] || 0) + value;
    }
  });

  // ‚ö†Ô∏è Now call your chart drawing logic (chart1, chart2, etc.)


  const incomeTotal = Object.values(monthlyIncome).reduce((a, b) => a + b, 0);
  const expenseTotal = Object.values(monthlyExpense).reduce((a, b) => a + b, 0);
  const difference = incomeTotal - expenseTotal;

  const months = [...new Set([...Object.keys(monthlyIncome), ...Object.keys(monthlyExpense)])].sort();
 
  const categories = Object.keys(expenseByCategory);

  const incomeMonthVals = months.map(m => monthlyIncome[m] || 0);
  const expenseMonthVals = months.map(m => monthlyExpense[m] || 0);
  const incomePersonVals = persons.map(p => personIncome[p] || 0);
  const expensePersonVals = persons.map(p => personExpense[p] || 0);
  const pieValues = categories.map(k => expenseByCategory[k]);

  const type = document.getElementById('chartType')?.value;

  // Chart contexts
  const ctx1 = document.getElementById('monthlyChart')?.getContext('2d');
  const ctx2 = document.getElementById('personChart')?.getContext('2d');
  const ctx3 = document.getElementById('comparisonChart')?.getContext('2d');
  const ctx4 = document.getElementById('pieChart')?.getContext('2d');
  const ctx5 = document.getElementById('summaryChart')?.getContext('2d');
  const avgCtx = document.getElementById('averageChart')?.getContext('2d');

  // Destroy old instances to avoid duplicates
  averageChartInstance?.destroy();
  monthlyChartInstance?.destroy();
  personChartInstance?.destroy();
  comparisonChartInstance?.destroy();
  pieChartInstance?.destroy();
  summaryChartInstance?.destroy();

  if (avgCtx) {
    const monthsCount = new Set(entries.map(e => e.date?.slice(0, 7))).size;
    const avgIncome = monthsCount ? incomeTotal / monthsCount : 0;
    const avgExpense = monthsCount ? expenseTotal / monthsCount : 0;
    const avgDiff = avgIncome - avgExpense;

    averageChartInstance = new Chart(avgCtx, {
      type: 'bar',
      data: {
        labels: ['Avg Income', 'Avg Expense', 'Avg Balance'],
        datasets: [{
          label: 'Average',
          data: [avgIncome, avgExpense, avgDiff],
          backgroundColor: ['#4caf50', '#f44336', '#2196f3']
        }]
      },
      plugins: [ChartDataLabels],
      options: {
        plugins: {
          datalabels: {
            anchor: 'end',
            align: 'top',
            font: { weight: 'bold' },
            formatter: v => v.toLocaleString('en-US', { minimumFractionDigits: 2 })
          }
        },
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }
if (ctx1) {
  monthlyChartInstance = new Chart(ctx1, {
    type,
    data: {
      labels: months,
      datasets: [
        { label: 'Income', data: incomeMonthVals, backgroundColor: '#4caf50', borderColor: '#2e7d32', borderWidth: 1 },
        { label: 'Expense', data: expenseMonthVals, backgroundColor: '#f44336', borderColor: '#c62828', borderWidth: 1 }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        tooltip: {
          callbacks: {
            label: context => `${context.dataset.label}: CHF ${Number(context.raw).toLocaleString('en-US', { minimumFractionDigits: 2 })}`
          },
          titleFont: {
            size: 14
          },
          bodyFont: {
            size: 20, // üëà Increase this to make sum larger
            weight: 'bold'
          },
          padding: 12
        },
        legend: {
          position: 'top',
          labels: {
            font: {
              size: 14
            }
          }
        },
        datalabels: {
          anchor: 'end',
          align: 'top',
          font: { weight: 'bold' },
          formatter: v => v.toLocaleString('en-US', { minimumFractionDigits: 2 })
        }
      },
      scales: {
        y: {
          beginAtZero: true
        }
      }
    },
    plugins: [ChartDataLabels]
  });
}

  if (ctx2) {
    personChartInstance = new Chart(ctx2, {
      type,
      data: {
        labels: persons,
        datasets: [
          { label: 'Income', data: incomePersonVals, backgroundColor: '#4caf50', borderColor: '#2e7d32', borderWidth: 1 },
          { label: 'Expense', data: expensePersonVals, backgroundColor: '#f44336', borderColor: '#c62828', borderWidth: 1 }
        ]
      },
      options: chartOptions(),
      plugins: [ChartDataLabels]
    });
  }

  if (ctx3) {
    comparisonChartInstance = new Chart(ctx3, {
      type,
      data: {
        labels: persons,
        datasets: [
          { label: 'Net Balance', data: persons.map(p => (personIncome[p] || 0) - (personExpense[p] || 0)), backgroundColor: '#2196f3', borderColor: '#1976d2', borderWidth: 1 }
        ]
      },
      options: chartOptions(),
      plugins: [ChartDataLabels]
    });
  }

  if (ctx5) {
    summaryChartInstance = new Chart(ctx5, {
      type: 'bar',
      data: {
        labels: ['Income', 'Expenses', 'Difference'],
        datasets: [{
          label: 'Summary',
          data: [incomeTotal, expenseTotal, difference],
          backgroundColor: ['#4caf50', '#f44336', '#2196f3']
        }]
      },
      options: {
        plugins: {
          datalabels: {
            anchor: 'end',
            align: 'top',
            font: { weight: 'bold' },
            formatter: value => value.toLocaleString('en-US', { minimumFractionDigits: 0 })
          }
        },
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }

  if (ctx4) {
    pieChartInstance = new Chart(ctx4, {
      type: 'pie',
      data: {
        labels: categories,
        datasets: [{
          label: 'Spending Distribution',
          data: pieValues,
          backgroundColor: categories.map((_, i) => `hsl(${i * 35}, 70%, 60%)`)
        }]
      },
      options: {
        responsive: true,
        plugins: {
          tooltip: {
            callbacks: {
              label: context => `${context.label}: CHF ${context.raw.toFixed(2)}`
            }
          },
          legend: { position: 'bottom' }
        }
      }
    });
  }

populatePersonDropdownForCharts(persons);
} // ‚Üê‚úÖ THIS is the real end of drawCharts()



    function populateCategoryFilter(entries) {
  const select = document.getElementById('categoryFilter');
  if (!select) return;
  const current = select.value;
  const categories = [...new Set(entries.map(e => e.category).filter(Boolean))].sort();
  select.innerHTML = '<option value="All">All</option>' + categories.map(c => `<option value="${c}">${c}</option>`).join('');
  select.value = current;
}

function chartOptions() {
  return {
    responsive: true,
    plugins: {
      tooltip: {
        callbacks: {
          label: context => `CHF ${Number(context.raw).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
        }
      },
      legend: { display: true },
      datalabels: {
        color: '#000',
        anchor: 'end',
        align: 'top',
        font: {
          weight: 'bold'
        },
        formatter: value => value.toFixed(2)
      }
    },
    scales: {
      y: {
        beginAtZero: true
      }
    }
  };
}

    function downloadChart(id) {
      const canvas = document.getElementById(id);
      const link = document.createElement('a');
      link.download = id + '.png';
      link.href = canvas.toDataURL();
      link.click();
    }


    document.getElementById('chartType')?.addEventListener('change', drawCharts);
    document.getElementById('personDropdown')?.addEventListener('change', drawCharts);
document.getElementById('categoryFilter')?.addEventListener('change', drawCharts);
</script>

<script>
function openTab(tabId, btn) {
  document.querySelectorAll('.tab-content').forEach(div => div.classList.remove('active'));
  document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));

  const targetTab = document.getElementById(tabId);
  if (targetTab) targetTab.classList.add('active');

  if (btn) btn.classList.add('active');

if (tabId === 'chartsTab') {
  setTimeout(() => {
    populateFilters();  // ‚Üê ‚úÖ Add this
    drawCharts();
  }, 50);
}
}
</script>

<div class="scroll-toggle-wrapper">
  
  <button class="scroll-toggle-btn" id="scrollUpBtn" title="Scroll to Top">‚¨Ü</button>
  <button class="scroll-toggle-btn" id="scrollDownBtn" title="Scroll to Bottom">‚¨á</button>
</div>


 

<script>
  document.addEventListener('DOMContentLoaded', () => {
  const toggleBtn = document.querySelector('.dropdown-toggle');
  const dropdown = document.getElementById('personDropdown');

  if (toggleBtn && dropdown) {
    toggleBtn.addEventListener('click', (e) => {
      e.stopPropagation(); // don't bubble to body
      dropdown.classList.toggle('show');
      console.log("‚úÖ Person dropdown clicked");
    });

    // Close dropdown on outside click
    document.addEventListener('click', (e) => {
      if (!dropdown.contains(e.target) && !toggleBtn.contains(e.target)) {
        dropdown.classList.remove('show');
      }
    });
  }
});
</script>


<div id="confirmModal" class="modal hidden">
  <div class="modal-content">
    <p>üóëÔ∏è Are you sure you want to delete this entry?</p>
    <div class="modal-actions">
      <button id="cancelDelete" class="btn cancel">Cancel</button>
      <button id="confirmDelete" class="btn confirm">Delete</button>
    </div>
  </div>
</div>
<div id="toast" style="display:none; position: fixed; bottom: 20px; right: 20px; background: #13a07f; color: white; padding: 12px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-size: 16px; z-index: 1000;"></div>





<div class="filter-grid">
 <!-- Entry table -->

  <div id="entryTableBody" class="desktop-card-list"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script src="dashboard.js"></script>
</body>
</html>


